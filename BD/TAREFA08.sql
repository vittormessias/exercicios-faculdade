--DROP DATABASE TAREFA08;

CREATE DATABASE TAREFA08;

USE TAREFA08;

-- Criar as tabelas x Relacionamentos: --
CREATE TABLE CLIENTES(
CODCLI INT,
NOME VARCHAR(30),
ENDERECO VARCHAR(40),
CIDADE VARCHAR(30),
FONE VARCHAR(9),
IDADE INT,
CONSTRAINT PK_CLIENTES PRIMARY KEY(CODCLI));

CREATE TABLE TRANSPORTADORA(
CODIGO INT,
NOME VARCHAR(20),
CONSTRAINT PK_TRANSPORTADORA PRIMARY KEY(CODIGO));

CREATE TABLE PEDIDOS(
NUMPED INT,
CLIENTE INT,
DATA_ENTREGA DATE,
CODIGO INT,
CONSTRAINT PK_PEDIDOS PRIMARY KEY(NUMPED),
CONSTRAINT FK_CLIENTES FOREIGN KEY(CLIENTE)
REFERENCES CLIENTES(CODCLI),
CONSTRAINT FK_TRANSPORTADORA FOREIGN KEY(CODIGO)
REFERENCES TRANSPORTADORA(CODIGO));

--INSERIR 5 ATRIBUTOS PARA CLIENTES.
INSERT INTO CLIENTES VALUES
(1,'JOAO','RUA DOS SACIS','BH',11555-5555,25),
(2,'MARIA','RUA DOS COQUEIROS','SP',215555-555,18),
(3,'PEDRO','RUA DOS NEGOS','PI',157777-7777,34),
(4,'GUILHERME','RUA DA MARIA','AM',26888-8888,54),
(5,'RODRIGO FARO','RUA SÃO FRANCISCO','PR',14555-5555,64);

--INSERIR 5 ATRIBUTOS PARA TRANSPORTADORA.
INSERT INTO TRANSPORTADORA VALUES
(1,'CORREIOS'),
(2,'AMAZON'),
(3,'SEDEX'),
(4,'PAC'),
(5,'ABC');

--INSERIR 5 ATRIBUTOS PARA PEDIDOS.
INSERT INTO PEDIDOS VALUES
(1,5,'20-11-2022',3),
(2,4,'12-06-2021',1),
(3,1,'20-11-2020',5),
(4,2,'10-02-2023',4),
(5,3,'14-05-2020',2);


-- Selecionar todos os pedidos da transportadora ABC.
SELECT * FROM PEDIDOS WHERE CODIGO IN (5);

--Quantos pedidos existem para o cliente 2?
SELECT * FROM PEDIDOS WHERE CLIENTE = 2;

--SELECIONAR O NÚMERO MAIS RECENTE DE PEDIDOS.
SELECT IDENT_CURRENT(NUMPED) as 'PEDIDOS RECENTES' FROM PEDIDOS;

--QUANTOS PEDIDOS PARA A TRANSPORTADORA ABC.
SELECT * FROM PEDIDOS WHERE CODIGO = 4;

--QUANTOS CLIENTES RESIDEM EM MAUÁ.
SELECT * FROM CLIENTES WHERE CIDADE IN ('MAUÁ');

--SELECIONAR NÚMERO DO PEDIDO, DATA DE ENTREGA E NOME DO CLIENTE.
SELECT PEDIDOS.NUMPED, PEDIDOS.DATA_ENTREGA, CLIENTES.NOME FROM CLIENTES, PEDIDOS;

--SELECIONAR NÚMERO DO PEDIDO, NOME DO CLIENTE E NOME DA TRANSPORTADORA.
SELECT PEDIDOS.NUMPED, CLIENTES.NOME, TRANSPORTADORA.NOME FROM CLIENTES, PEDIDOS, TRANSPORTADORA;

--SELECIONAR TODOS OS CLIENTES DA CIDADE DE SANTO ANDRÉ, MAUÁ E SBC.
SELECT * FROM CLIENTES WHERE CIDADE IN ('SANTO ANDRÉ','MAUÁ','SBC');

--QUANTOS CLIENTES TEMOS ACIMA DA MÉDIA DE IDADE?
SELECT * FROM CLIENTES WHERE IDADE > 39;

--QUANTOS PEDIDOS TEMOS NA DATA MAIS RECENTE?
SELECT MAX(3) FROM PEDIDOS;

--SELECIONAR OS CLIENTES COM IDADE ABAIXO DA MÉDIA.
SELECT * FROM CLIENTES WHERE IDADE < 39;
